(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{k5Mu:function(e,t,n){"use strict";n.r(t);var r=n("gWZ8"),a=n.n(r),u=n("jHYr"),o=n.n(u),s=n("d6i3"),c=n.n(s),i=n("p0pE"),p=n.n(i),l=(n("1l/V"),n("io9h"));function d(e){return Object(l.a)("/api/transform/info")}function f(e){return Object(l.a)("/api/transform/".concat(e.id),{method:"POST",params:{id:e.id},data:e})}function m(e){return Object(l.a)("/api/transform",{method:"POST",data:e})}function y(e){return Object(l.a)("/api/transform/debug",{method:"POST",data:e})}function v(e){return Object(l.a)("/api/transform/".concat(e.id))}function x(e){return Object(l.a)("/api/transform/".concat(e.id,"/run"),{method:"POST",params:{id:e.id},data:e})}var b={namespace:"formStepForm",state:{current:"list",namespaces:[],targetKeys:[],resourceColumns:[],detailColumns:[]},effects:{initStepFromList:c.a.mark(function e(t,n){var r,a,u,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.payload,a=n.call,u=n.put,e.next=4,a(v,r);case 4:return o=e.sent,e.next=7,u({type:"updateColumnDetail",payload:o.data.resources.columns});case 7:return e.next=9,u({type:"saveStepFormData",payload:p()({},r,o.data.detail)});case 9:return e.next=11,u({type:"saveCurrentStep",payload:"result"});case 11:case"end":return e.stop()}},e)}),initSource:c.a.mark(function e(t,n){var r,a,u;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o()(t),r=n.call,a=n.put,e.next=4,r(d);case 4:return u=e.sent,e.next=7,a({type:"sourceTableInit",payload:u.data});case 7:return e.next=9,a({type:"saveCurrentStep",payload:"list"});case 9:case"end":return e.stop()}},e)}),initSourceColumn:c.a.mark(function e(t,n){var r,u,s,i,p,l,d,f,m;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o()(t),r=n.put,u=n.select,e.next=4,u(function(e){return e.formStepForm.targetKeys});case 4:return s=e.sent,e.next=7,u(function(e){return e.formStepForm.detailColumns});case 7:return i=e.sent,e.next=10,u(function(e){return e.formStepForm.resourceColumns});case 10:return p=e.sent,l=i.filter(function(e){return s.indexOf(e.id)>=0}),d=l.map(function(e){return e.id}),f=p.filter(function(e){return s.indexOf(e.id)>=0&&d.indexOf(e.id)<0}),m=[].concat(a()(l),a()(f)),e.next=17,r({type:"updateColumnDetail",payload:m});case 17:case"end":return e.stop()}},e)}),submitStepForm:c.a.mark(function e(t,n){var r,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.payload,n.call,a=n.put,e.next=4,a({type:"saveStepFormData",payload:r});case 4:return e.next=6,a({type:"saveCurrentStep",payload:"result"});case 6:case"end":return e.stop()}},e)}),submintTransformTable:c.a.mark(function e(t,n){var r,a,u,o,s,i,l,d,y;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.payload,a=t.callback,u=n.call,o=n.put,s=n.select,i=void 0===r.id?m:f,e.next=5,s(function(e){return e.formStepForm.detailColumns});case 5:return l=e.sent,e.next=8,u(i,p()({},r,{columns:l}));case 8:if(!(d=e.sent).success){e.next=15;break}return y=p()({},r,d.data),e.next=13,o({type:"transform/"+(i===f?"updateList":"createOne"),payload:y});case 13:return e.next=15,o({type:"clearForm"});case 15:setTimeout(a,100,d);case 16:case"end":return e.stop()}},e)}),submitDebugTransformTable:c.a.mark(function e(t,n){var r,a,u,o,s,i,l;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.payload,a=t.callback,u=n.call,n.put,o=n.select,s=y,e.next=5,o(function(e){return e.formStepForm.detailColumns});case 5:return i=e.sent,e.next=8,u(s,p()({},r,{columns:i}));case 8:l=e.sent,setTimeout(a,100,l);case 10:case"end":return e.stop()}},e)}),runCurrentTransform:c.a.mark(function e(t,n){var r,a,u,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.payload,a=t.callback,u=n.call,e.next=4,u(x,p()({},r));case 4:o=e.sent,setTimeout(a,100,o);case 6:case"end":return e.stop()}},e)})},reducers:{updateTarget:function(e,t){var n=t.payload;return p()({},e,{targetKeys:n})},clearForm:function(e,t){return o()(t),p()({},e,{targetKeys:[],detail:void 0})},updateColumnDetail:function(e,t){var n=t.payload;return p()({},e,{detailColumns:n,targetKeys:n.map(function(e){return e.id})})},saveCurrentStep:function(e,t){var n=t.payload;return p()({},e,{current:n})},sourceTableInit:function(e,t){var n=t.payload;return p()({},e,{resourceColumns:n.columns,namespaces:n.namespaces})},saveStepFormData:function(e,t){var n=t.payload;return p()({},e,{detail:n})},deleteColumnTable:function(e,t){var n=t.id;return p()({},e,{detailColumns:e.detailColumns.filter(function(e){return e.id!==n}),targetKeys:e.targetKeys.filter(function(e){return n!==e})})},updateColumnTable:function(e,t){var n=t.payload;return p()({},e,{detailColumns:e.detailColumns.map(function(e){return e.id===n.id?p()({},e,n):e})})}},subscriptions:{setup:function(e){var t=e.history,n=e.dispatch;t.listen(function(e,t){"/transform"===e.pathname&&(n({type:"initSource"}),n({type:"transform/fetch"}))})}}};t.default=b}}]);