(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{"Dz5+":function(e,a,t){"use strict";t.r(a);var r=t("gWZ8"),n=t.n(r),s=t("p0pE"),c=t.n(s),l=(t("miYZ"),t("tsqr")),u=t("d6i3"),i=t.n(u),o=t("1l/V"),p=t.n(o),d=t("sy1d");function b(){return f.apply(this,arguments)}function f(){return(f=p()(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(d.a)(" /api/tables",{params:{_time:(new Date).getTime()}}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function m(e){return v.apply(this,arguments)}function v(){return(v=p()(i.a.mark(function e(a){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(d.a)("/api/table/".concat(a),{params:{_time:(new Date).getTime()}}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function y(e,a){return h.apply(this,arguments)}function h(){return(h=p()(i.a.mark(function e(a,t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(d.a)("/api/search/".concat(a),{params:c()({_time:(new Date).getTime()},t),data:t,method:"POST"}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var x={namespace:"visualization",state:{tables:[],relatedTables:[],details:[],search:"",selectTable:"",limit:-1,currentDisplayTables:[],selectRelatedTableKeys:[],errorDisplay:!1,errorCode:0,errorMsg:""},effects:{fetchTables:i.a.mark(function e(a,t){var r,n,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.payload,r=t.call,n=t.put,e.next=4,r(b);case 4:return s=e.sent,e.next=7,n({type:"save",payload:{tables:s.data.data}});case 7:case"end":return e.stop()}},e)}),doRefresh:i.a.mark(function e(a,t){var r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.call,r=t.put,e.next=3,r({type:"save",payload:{tables:[],relatedTables:[],details:[],selectTable:"",limit:-1,currentDisplayTables:[],selectRelatedTableKeys:[],errorDisplay:!1,errorCode:0,errorMsg:""}});case 3:return e.next=5,r({type:"fetchTables"});case 5:case"end":return e.stop()}},e)}),submitSearch:i.a.mark(function e(a,t){var r,n,s,c,u,o,p,d;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.payload,r=t.call,n=t.put,s=t.select,e.next=4,s(function(e){return e.visualization});case 4:return c=e.sent,u=c.limit,o=c.search,p=c.selectTable,e.next=10,r(y,p,{limit:u,search:o});case 10:if(0===(d=e.sent).code){e.next=15;break}return e.next=14,n({type:"save",payload:{errorDisplay:!0,errorCode:d.code,errorMsg:d.msg}});case 14:return e.abrupt("return");case 15:return e.next=17,n({type:"saveTableSearch",payload:d.data});case 17:l.a.destroy();case 21:case"end":return e.stop()}},e)}),hiddenTableDetail:i.a.mark(function e(a,t){var r,n,s,l,u,o,p,d;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.payload,t.call,n=t.put,s=t.select,l=r.tableName,e.next=5,s(function(e){return e.visualization.details.filter(function(e){return e.tableName==l})});case 5:u=e.sent,o=0;case 7:if(!(o<u.length)){e.next=15;break}return p=u[o],d=c()({},p,{show:r.check}),e.next=12,n({type:"saveTableSearch",payload:d});case 12:o++,e.next=7;break;case 15:case"end":return e.stop()}},e)}),submitSelectTable:i.a.mark(function e(a,t){var r,n,s,c;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.payload,n=t.call,s=t.put,e.next=4,s({type:"save",payload:{selectTable:r,selectRelatedTableKeys:[]}});case 4:return e.next=6,n(m,r);case 6:return c=e.sent,e.next=9,s({type:"save",payload:{relatedTables:Array.isArray(c.data.data)?c.data.data:[]}});case 9:case 12:case"end":return e.stop()}},e)}),submitSearchAll:i.a.mark(function e(a,t){var r,n,s,c,l,u,o,p,d,b,f,m;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.payload,t.call,n=t.put,s=t.select,e.next=5,s(function(e){return e.visualization});case 5:return c=e.sent,l=c.selectTable,e.next=9,s(function(e){return e.visualization});case 9:if(u=e.sent,void 0!==u.current){e.next=14;break}return e.next=14,n({type:"submitSearchOne",payload:{params:{selectTable:l,table:l}}});case 14:o=!0,p=!1,d=void 0,e.prev=17,b=r[Symbol.iterator]();case 19:if(o=(f=b.next()).done){e.next=29;break}return m=f.value,e.next=24,n({type:"saveTableSearch",payload:{tableName:m,loading:!0,show:!0}});case 24:return e.next=26,n({type:"submitSearchOne",payload:{params:{selectTable:l,table:m}}});case 26:o=!0,e.next=19;break;case 29:e.next=35;break;case 31:e.prev=31,e.t0=e.catch(17),p=!0,d=e.t0;case 35:e.prev=35,e.prev=36,o||null==b.return||b.return();case 38:if(e.prev=38,!p){e.next=41;break}throw d;case 41:return e.finish(38);case 42:return e.finish(35);case 43:case"end":return e.stop()}},e,null,[[17,31,35,43],[36,,38,42]])}),submitSearchOne:i.a.mark(function e(a,t){var r,n,s,l;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.payload,n=t.call,s=t.put,e.next=4,n(y,r.params.table,r.params);case 4:return l=e.sent,e.next=7,s({type:"saveTableSearch",payload:c()({},l.data,{loading:!1})});case 7:case"end":return e.stop()}},e)}),startChangeCurrentTable:i.a.mark(function e(a,t){var r,n,s,c;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.tableName,t.call,n=t.put,s=t.select,e.next=4,s(function(e){return e.visualization});case 4:if(c=e.sent,c.selectTable===r){e.next=9;break}return e.next=9,n({type:"submitSelectTable",payload:r});case 9:return e.next=11,n({type:"changeCurrentTable",tableName:r});case 11:case"end":return e.stop()}},e)})},reducers:{save:function(e,a){var t=a.payload;return c()({},e,t)},saveTableSearch:function(e,a){var t,r=a.payload;if(void 0!==(t=void 0!==e&&r.tableName===e.selectTable?c()({},e,{current:r}):e)&&0===t.details.filter(function(e){return e.tableName===r.tableName}).length){var s=[].concat(n()(t.details),[r]);return c()({},t,{details:s})}if(void 0!==t){var l=t.details.map(function(e){return e.tableName===r.tableName?r:e});return c()({},t,{details:l})}},changeCurrentTable:function(e,a){var t=a.tableName;if(void 0!==e){var r=e.details.filter(function(e){return e.tableName===t});if(r.length>0){var n=r[0];return c()({},e,{current:n,selectTable:n.tableName,search:n.search,limit:n.limit})}}return e},deleteTable:function(e,a){var t=a.tableName;return c()({},e,{details:e.details.filter(function(e){return e.tableName!==t})})}}};a.default=x}}]);