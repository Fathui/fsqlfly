(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{FuSl:function(e,t,a){"use strict";a.r(t);a("Mwp2");var n=a("VXEj"),l=(a("IzEo"),a("bx4M")),r=(a("BoS7"),a("Sdc0")),i=(a("jCWc"),a("kPKH")),s=(a("14J3"),a("BMrR")),c=(a("lUTK"),a("BvKs")),o=(a("qVdP"),a("jsC+")),u=(a("MXD1"),a("CFYs")),d=(a("+BJd"),a("mr32")),m=(a("Pwec"),a("CtXQ")),p=(a("+L6B"),a("2/Rp")),h=(a("2qtc"),a("kLXV")),f=a("p0pE"),E=a.n(f),g=a("2Taf"),b=a.n(g),y=a("vZ4D"),v=a.n(y),C=a("l4Ni"),k=a.n(C),S=a("ujKo"),w=a.n(S),x=a("MhPg"),M=a.n(x),O=(a("7Kak"),a("9yH6")),V=(a("5NDa"),a("5rEg")),D=(a("y8nQ"),a("Vl3Y")),L=(a("OaEy"),a("2fM7")),P=a("q1tI"),j=a.n(P),N=a("i8i4"),B=a("wd/R"),I=a.n(B),R=a("MuoO"),q=a("WnL9"),T=a("Hx5s"),F=a("xM2q"),Y=a("4NGg"),A=a.n(Y),H=function(e,t,a,n){var l,r=arguments.length,i=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,a,n);else for(var s=e.length-1;s>=0;s--)(l=e[s])&&(i=(r<3?l(i):r>3?l(t,a,i):l(t,a))||i);return r>3&&i&&Object.defineProperty(t,a,i),i},z=L.a.Option,K=D.a.Item,J=V.a.Search,X=O.a.Group,U=O.a.Button,W="connection",G=function(e){function t(){var e;return b()(this,t),(e=k()(this,w()(t).apply(this,arguments))).state={visible:!1,runVisible:!1,done:!1,current:void 0,search:"",msg:"",success:!1,submitted:!1,pageSize:5,currentPage:1,tag:""},e.formLayout={labelCol:{span:5},wrapperCol:{span:17}},e.normFile=function(e){return Array.isArray(e)?e:e&&e.fileList},e.doRefresh=function(){(0,e.props.dispatch)({type:"".concat(W,"/fetch")})},e.showModal=function(){e.setState({visible:!0,submitted:!1,current:{}})},e.showEditModal=function(t){e.setState({visible:!0,current:t,submitted:!1})},e.showManageModal=function(t,a){e.setState({runVisible:!0,done:!1,msg:""}),(0,e.props.dispatch)({type:"".concat(W,"/run"),payload:{method:a,model:W,id:t.id},callback:function(t){e.setState({msg:t.msg,done:!0,success:t.success})}})},e.handleDone=function(){setTimeout(function(){return e.addBtn&&e.addBtn.blur()},0),e.setState({done:!1,visible:!1})},e.handleCancel=function(){setTimeout(function(){return e.addBtn&&e.addBtn.blur()},0),e.setState({visible:!1})},e.handleUpdate=function(t){e.handleSubmit(t,!0)},e.handleSubmit=function(t,a){t.preventDefault();var n=e.props,l=n.dispatch,r=n.form,i=e.state.current;setTimeout(function(){return e.addBtn&&e.addBtn.blur()},0),r.validateFields(function(t,a){t||(e.setState({submitted:!0}),l({type:"".concat(W,"/submit"),payload:E()({},i,a),callback:function(t){e.setState({done:!0,success:t.success,msg:t.msg})}}))})},e.deleteItem=function(t){(0,e.props.dispatch)({type:"".concat(W,"/submit"),payload:{id:t}})},e.onSearch=function(t,a){e.setState({search:t,currentPage:1})},e.getFilterPageData=function(){var t=e.state,a=t.search,n=t.tag,l=e.props.listBasicList.filter(function(e){return(0===a.length||e.name.indexOf(a)>=0)&&(0===n.length||n===e.typ)});return l},e.getCurrentPageData=function(){var t=e.state,a=t.pageSize,n=t.currentPage;return e.getFilterPageData().slice((n-1)*a,n*a)},e.onPageChange=function(t,a){e.setState({pageSize:a,currentPage:t})},e.onTagChage=function(t){t.preventDefault(),e.setState({tag:t.target.value})},e}return M()(t,e),v()(t,[{key:"componentDidMount",value:function(){this.doRefresh()}},{key:"render",value:function(){var e=this,t=["mysql","hiveServer2Thrift","kafka"],a=this.props.loading,f=this.props.form.getFieldDecorator,E=this.state,g=E.visible,b=E.done,y=E.current,v=void 0===y?{}:y,C=E.search,k=E.success,S=E.msg,w=E.submitted,x=E.currentPage,M=b?{footer:null,onCancel:this.handleDone}:{okText:"保存",onOk:this.handleSubmit,onCancel:this.handleCancel,footer:[j.a.createElement(p.a,{key:"back",onClick:this.handleCancel},"取消"),j.a.createElement(p.a,{key:"submit",type:"primary",loading:w,onClick:this.handleSubmit},"保存")]},O=j.a.createElement("div",{className:A.a.extraContent},j.a.createElement(p.a,{onClick:this.doRefresh},j.a.createElement(m.a,{type:"reload"})),j.a.createElement(X,{defaultValue:null,onChange:this.onTagChage},j.a.createElement(U,{value:""},"全部"),t.map(function(e){return j.a.createElement(U,{key:e,value:e},e)})),j.a.createElement(J,{defaultValue:C,className:A.a.extraContentSearch,placeholder:"请输入",onSearch:this.onSearch})),P=function(e){var t=e.data,a=(t.name,t.typ),n=t.isAvailable,l=t.isPublish,r=t.createAt,i=t.updateAt;return j.a.createElement("div",{className:A.a.listContent},j.a.createElement("div",{className:A.a.listContentItem},j.a.createElement("p",null,j.a.createElement(d.a,null,a))),j.a.createElement("div",{className:A.a.listContentItem},j.a.createElement("span",null,"创建时间"),j.a.createElement("p",null,I()(r).format("YYYY-MM-DD HH:mm"))),j.a.createElement("div",{className:A.a.listContentItem},j.a.createElement("span",null,"修改时间"),j.a.createElement("p",null,I()(i).format("YYYY-MM-DD HH:mm"))),j.a.createElement("div",{className:A.a.listContentItem},j.a.createElement(u.a,{type:"circle",percent:100,status:n?l?"success":"normal":"exception",strokeWidth:1,width:50,style:{width:180}})))},B=function(t){var a=t.item;return j.a.createElement(o.a,{overlay:j.a.createElement(c.a,{onClick:function(t){return function(t,a){"edit"===t?e.showEditModal(a):"update"==t?e.showManageModal(a,"update"):"upgrade"==t?e.showManageModal(a,"upgrade"):"delete"===t&&h.a.confirm({title:"删除",content:"确定删除吗？",okText:"确认",cancelText:"取消",onOk:function(){return e.deleteItem(a.id?a.id:0)}})}(t.key,a)}},j.a.createElement(c.a.Item,{key:"delete"},"删除"),j.a.createElement(c.a.Item,{key:"update"},"更新"))},j.a.createElement("a",null,"更多 ",j.a.createElement(m.a,{type:"down"})))};return j.a.createElement(j.a.Fragment,null,j.a.createElement(T.b,null,j.a.createElement("div",{className:A.a.standardList},j.a.createElement(l.a,{className:A.a.listCard,bordered:!1,title:"列表",style:{marginTop:24},bodyStyle:{padding:"0 32px 40px 32px"},extra:O},1===x&&j.a.createElement(p.a,{type:"dashed",style:{width:"100%",marginBottom:8},icon:"plus",onClick:this.showModal,ref:function(t){e.addBtn=Object(N.findDOMNode)(t)}},"添加"),j.a.createElement(n.a,{size:"large",rowKey:"id",loading:a,dataSource:this.getFilterPageData(),renderItem:function(t){return j.a.createElement(n.a.Item,{actions:[j.a.createElement("a",{key:"edit",onClick:function(a){a.preventDefault(),e.showEditModal(t)}},"编辑"),j.a.createElement(B,{key:"more",item:t})]},j.a.createElement(n.a.Item.Meta,{title:j.a.createElement("a",{href:"#"},t.name),description:t.info}),j.a.createElement(P,{data:t}))}}))),j.a.createElement(h.a,{title:"运行结果",className:A.a.standardListForm,width:1080,bodyStyle:{padding:"72px 0"},destroyOnClose:!0,visible:this.state.runVisible,onCancel:function(t){return e.setState({runVisible:!1})},footer:null,confirmLoading:this.state.done},j.a.createElement(q.a,{type:this.state.done?this.state.success?"success":"error":"line",title:this.state.done?this.state.success?"运行成功":"运行失败":"提交中...",extra:this.state.msg,actions:j.a.createElement(p.a,{loading:!this.state.done,type:"primary",onClick:function(t){return e.setState({runVisible:!1})}},"知道了"),className:A.a.formResult}))),j.a.createElement(h.a,Object.assign({title:b?null:"文件".concat(v?"编辑":"添加"),className:A.a.standardListForm,width:1080,bodyStyle:b?{padding:"72px 0"}:{padding:"28px 0 0"},destroyOnClose:!0,visible:g},M),(v.name,b?j.a.createElement(q.a,{type:k?"success":"error",title:"操作 ".concat(k?"成功":"失败"),description:k?"":S,actions:j.a.createElement(p.a,{type:"primary",onClick:e.handleDone},"知道了"),className:A.a.formResult}):j.a.createElement(D.a,{onSubmit:e.handleSubmit},j.a.createElement(K,Object.assign({label:"名称"},e.formLayout),f("name",{rules:F.a,initialValue:v.name})(j.a.createElement(V.a,{placeholder:"请输入"}))),j.a.createElement(K,Object.assign({label:"类型"},e.formLayout),f("typ",{initialValue:v.typ,rules:[{required:!0}]})(j.a.createElement(L.a,{placeholder:"请选择",size:"default",style:{width:120}},t.map(function(e){return j.a.createElement(z,{key:e,value:e},e)})))),j.a.createElement(K,Object.assign({label:"connectionUrl"},e.formLayout),f("url",{initialValue:v.url,rules:[{required:!0}]})(j.a.createElement(V.a,{placeholder:"请输入"}))),j.a.createElement(K,Object.assign({label:"后缀"},e.formLayout),f("suffix",{initialValue:v.suffix,rules:[{required:!0}]})(j.a.createElement(V.a,{placeholder:"请输入"}))),j.a.createElement(K,Object.assign({label:"表过滤正则"},e.formLayout),f("tableRegex",{initialValue:v.tableRegex,rules:[{required:!1}]})(j.a.createElement(V.a,{placeholder:"使用逗号分割多个正则表达"}))),j.a.createElement(K,Object.assign({label:"表排除正则"},e.formLayout),f("tableExcludeRegex",{initialValue:v.tableExcludeRegex,rules:[{required:!1}]})(j.a.createElement(V.a,{placeholder:"使用逗号分割多个正则表达"}))),j.a.createElement(K,Object.assign({label:"username"},e.formLayout),f("username",{initialValue:v.username,rules:[{required:!1}]})(j.a.createElement(V.a,{placeholder:"请输入"}))),j.a.createElement(K,Object.assign({label:"password"},e.formLayout),f("password",{initialValue:v.password,rules:[{required:!1}]})(j.a.createElement(V.a,{type:"password",placeholder:"请输入"}))),j.a.createElement(K,Object.assign({label:"自动更新周期（s）"},e.formLayout),f("updateInterval",{initialValue:v.updateInterval,rules:[{required:!0}]})(j.a.createElement(V.a,{type:"number",placeholder:"请输入"}))),j.a.createElement(K,Object.assign({label:"其他"},e.formLayout),j.a.createElement(s.a,{gutter:16},j.a.createElement(i.a,{span:3},f("isAvailable",{initialValue:v.isAvailable,valuePropName:"checked"})(j.a.createElement(r.a,{checkedChildren:"启用",unCheckedChildren:"禁止"}))),j.a.createElement(i.a,{span:3},f("isPublish",{initialValue:v.isPublish,valuePropName:"checked"})(j.a.createElement(r.a,{checkedChildren:"发布",unCheckedChildren:"开发"})))))))))}}]),t}(P.Component);G=H([Object(R.connect)(function(e){var t=e.connection,a=e.loading;e.total;return{listBasicList:t.list,loading:a.models.file}})],G),t.default=D.a.create()(G)}}]);